<script type="text/javascript">
    RED.nodes.registerType('power-saver',{
        category: 'function',
        color: '#a6bbcf',
        defaults: {
            name: {value: ""},
            maxHoursToSavePerDay: {value: "12", required: true},
            maxHoursToSaveInSequence: {value: "3", required: true},
            minHoursOnAfterMaxSequenceSaved: {value: "2", required: true}
        },
        inputs:1,
        outputs:3,
        icon: "file.png",
        label: function() {
            return this.name||"power-saver";
        }
    });
</script>

<script type="text/html" data-template-name="power-saver">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-maxHoursToSavePerDay"><i class="fa fa-tag"></i> Max per day</label>
        <input type="number" id="node-input-maxHoursToSavePerDay" placeholder="Max hours to save in a day">
    </div>
    <div class="form-row">
        <label for="node-input-maxHoursToSaveInSequence"><i class="fa fa-tag"></i> Max per sequence</label>
        <input type="number" id="node-input-maxHoursToSaveInSequence" placeholder="Max hours to save in sequence">
    </div>
    <div class="form-row">
        <label for="node-input-minHoursOnAfterMaxSequenceSaved"><i class="fa fa-tag"></i> Min recover</label>
        <input type="number" id="node-input-minHoursOnAfterMaxSequenceSaved" placeholder="Min hours on after a max sequence">
    </div>
</script>

<script type="text/html" data-help-name="power-saver">
    <p>A node to turn on and off a switch based on power prices.</p>
    <h3>Input</h3>
    <dl class="message-properties">
        <dt>payload
            <span class="property-type">object</span>
        </dt>
        <dd> The payload should be an object with two arrays: raw_today and raw_tomorrow.
            Each array shall contain one object per hour, with attributes start, end and value.
            <br>
            This is exactly what is received by the ??? node, so just put the output from that node to the input of this node.
        </dd>
    </dl>

 <h3>Outputs</h3>
     <ol class="node-ports">
         <li>Output 1
             <dl class="message-properties">
                 <dt>payload <span class="property-type">string</span></dt>
                 <dd>A payload is sent to this output when the power shall be turned on.</dd>
             </dl>
         </li>
         <li>Output 2
             <dl class="message-properties">
                 <dt>payload <span class="property-type">string</span></dt>
                 <dd>A payload is sent to this output when the power shall be turned off.</dd>
             </dl>
         </li>
         <li>Output 3
             <dl class="message-properties">
                 <dt>payload <span class="property-type">string</span></dt>
                 <dd>A complete schedule is sent to this output whenever it is set or changed.</dd>
             </dl>
         </li>
     </ol>

<h3>Details</h3>
    <p><code>msg.payload</code> is used as the payload of the published message.
    If it contains an Object it will be converted to a JSON string before being sent.
    If it contains a binary Buffer the message will be published as-is.</p>
    <p>The topic used can be configured in the node or, if left blank, can be set
    by <code>msg.topic</code>.</p>
    <p>Likewise the QoS and retain values can be configured in the node or, if left
    blank, set by <code>msg.qos</code> and <code>msg.retain</code> respectively.</p>

<h3>References</h3>
    <ul>
        <li><a>Twitter API docs</a> - full description of <code>msg.tweet</code> property</li>
        <li><a>GitHub</a> - the nodes github repository</li>
    </ul>    
</script>